import{a as q,b as ge,d as fe,e as ve}from"./chunk-6L4FUCBT.js";import{A as w,B as M,C as s,Ca as j,D as l,E as p,F as h,G as u,H as c,I as k,J as Q,K as g,L as W,M as f,N as $,P as d,Q as I,R as V,Ra as E,Sa as re,T as X,Ta as ae,U as Y,V as Z,X as C,ba as ee,c as G,d as J,f as m,fa as L,fb as ne,ga as A,gb as oe,h as b,hb as pe,i as _,ia as N,ib as le,ja as te,jb as se,kb as me,l as x,lb as de,mb as ce,n,na as H,o as R,oa as ie,p as v,sb as ue,w as D,x as K,y as T}from"./chunk-5ITVCH6E.js";var we=(r,t)=>t.name;function Me(r,t){if(r&1&&(u(0,"div",10)(1,"span"),d(2),c(),u(3,"div",14)(4,"span",15),d(5),c(),u(6,"span",16),d(7),c()()()),r&2){let e=t.$implicit;n(2),I(e.name),n(3),V("",e.count," prompts"),n(2),V("(",e.percentage,"%)")}}function ke(r,t){if(r&1&&(u(0,"div",3)(1,"div",4)(2,"div",5)(3,"div",6),d(4),c(),u(5,"div",7),d(6,"Total"),c()(),u(7,"div",5)(8,"div",6),d(9),c(),u(10,"div",7),d(11,"Promedio"),c()(),u(12,"div",5)(13,"div",6),d(14),c(),u(15,"div",7),d(16,"Mediana"),c()(),u(17,"div",5)(18,"div",6),d(19),c(),u(20,"div",7),d(21,"Percentil 75"),c()()(),u(22,"div")(23,"h3",8),d(24,"\u{1F4CA} Distribuci\xF3n por Rangos"),c(),u(25,"div",9),w(26,Me,8,3,"div",10,we),c()(),u(28,"div",11)(29,"h3",12),d(30," \u{1F4A1} Recomendaci\xF3n para Edici\xF3n Inline "),c(),u(31,"p",13),d(32),c()()()),r&2){let e=t,i=f();n(4),I(e.total),n(5),I(e.avg),n(5),I(e.median),n(5),I(e.p75),n(7),M(e.ranges),n(6),V(" ",i.getRecommendation(e)," ")}}var O=class r{appData=m(E);loading=x(!1);stats=x(null);async analyzePrompts(){this.loading.set(!0);try{let t=this.appData.prompts();if(t.length===0){alert("No hay prompts para analizar");return}let e=t.map(S=>S.prompt?.length||0).filter(S=>S>0).sort((S,P)=>S-P),i=e.length,a=Math.min(...e),o=Math.max(...e),y=Math.round(e.reduce((S,P)=>S+P,0)/i),U=e[Math.floor(i/2)],Ee=e[Math.floor(i*.25)],Ce=e[Math.floor(i*.75)],Pe=e[Math.floor(i*.9)],De=[{name:"Muy cortos (< 100)",min:0,max:99},{name:"Cortos (100-300)",min:100,max:300},{name:"Medianos (301-600)",min:301,max:600},{name:"Largos (601-1000)",min:601,max:1e3},{name:"Muy largos (> 1000)",min:1001,max:1/0}].map(S=>{let P=e.filter(B=>B>=S.min&&B<=S.max).length,Te=Math.round(P/i*100);return{name:S.name,count:P,percentage:Te}});this.stats.set({total:i,min:a,max:o,avg:y,median:U,p25:Ee,p75:Ce,p90:Pe,ranges:De})}finally{this.loading.set(!1)}}getRecommendation(t){return t.p75<=300?`El 75% de tus prompts tienen \u2264 ${t.p75} caracteres. Recomendaci\xF3n: L\xEDmite para edici\xF3n inline = 300 caracteres.`:t.median<=300?`El 50% de tus prompts tienen \u2264 ${t.median} caracteres. Recomendaci\xF3n: L\xEDmite para edici\xF3n inline = 400 caracteres.`:`La mayor\xEDa de tus prompts son largos (mediana: ${t.median} caracteres). Recomendaci\xF3n: L\xEDmite para edici\xF3n inline = 200 caracteres (solo cambios r\xE1pidos).`}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=v({type:r,selectors:[["pd-prompt-analyzer"]],decls:6,vars:3,consts:[[1,"p-6","bg-white","dark:bg-gray-800","rounded-lg","shadow-lg"],[1,"text-2xl","font-bold","mb-4"],[1,"mb-6","px-4","py-2","bg-blue-500","text-white","rounded","hover:bg-blue-600","disabled:opacity-50",3,"click","disabled"],[1,"space-y-6"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-4"],[1,"text-center","p-3","bg-gray-100","dark:bg-gray-700","rounded"],[1,"text-2xl","font-bold"],[1,"text-sm","text-gray-600","dark:text-gray-300"],[1,"text-lg","font-semibold","mb-3"],[1,"space-y-2"],[1,"flex","items-center","justify-between","p-2","bg-gray-50","dark:bg-gray-700","rounded"],[1,"p-4","bg-blue-50","dark:bg-blue-900/20","border-l-4","border-blue-400","rounded"],[1,"text-lg","font-semibold","text-blue-800","dark:text-blue-200","mb-2"],[1,"text-blue-700","dark:text-blue-300"],[1,"flex","items-center","space-x-2"],[1,"font-medium"],[1,"text-sm","text-gray-500"]],template:function(e,i){if(e&1&&(u(0,"div",0)(1,"h2",1),d(2,"\u{1F4CA} An\xE1lisis de Longitud de Prompts"),c(),u(3,"button",2),W("click",function(){return i.analyzePrompts()}),d(4),c(),D(5,ke,33,5,"div",3),c()),e&2){let a;n(3),Q("disabled",i.loading()),n(),V(" ",i.loading()?"\u23F3 Analizando...":"\u{1F50D} Analizar Prompts"," "),n(),T((a=i.stats())?5:-1,a)}},encapsulation:2})};var he=class r{static \u0275fac=function(e){return new(e||r)};static \u0275cmp=v({type:r,selectors:[["pd-admin-page"]],decls:3,vars:0,consts:[[1,"space-y-8","p-6"]],template:function(e,i){e&1&&(l(0,"div",0),h(1,"pd-admin-management")(2,"pd-prompt-analyzer"),p())},dependencies:[ve,O],encapsulation:2})};var ye=class r{enabled=x(!1);submitting=x(!1);static \u0275fac=function(e){return new(e||r)};static \u0275cmp=v({type:r,selectors:[["pd-create-prompt-page"]],decls:3,vars:2,consts:[["form",""],["titulo","Nuevo Prompt",3,"apply","enabled","waiting"],[3,"valid","submiting"]],template:function(e,i){if(e&1){let a=k();l(0,"pd-task-header",1),g("apply",function(y){b(a);let U=$(2);return _(U.onSubmit(y))}),p(),l(1,"pd-create-prompt-form",2,0),g("valid",function(y){return b(a),_(i.enabled.set(y))})("submiting",function(y){return b(a),_(i.submitting.set(y))}),p()}e&2&&s("enabled",i.enabled())("waiting",i.submitting())},dependencies:[me,ge],encapsulation:2})};function Ie(r,t){if(r&1&&(l(0,"div",3),h(1,"ul",5),p()),r&2){let e=f();n(),s("prompts",e.persistService.prompts())}}function Ae(r,t){r&1&&(l(0,"div",4)(1,"span",6)(2,"span",7),h(3,"span",8)(4,"span",9),p()(),l(5,"span",10),d(6,"cargando"),p(),l(7,"span",10),d(8,"prompts"),p()())}var be=class r{persistService=m(E);static \u0275fac=function(e){return new(e||r)};static \u0275cmp=v({type:r,selectors:[["pd-home"]],hostAttrs:[1,"w-full"],decls:6,vars:1,consts:[["drawer",""],["pd-main-header","",3,"open"],["pd-drawer","",1,"w-fit","select-none"],[1,"flex","flex-row","md:ml-72"],[1,"flex","flex-col","md:ml-72","items-center","justify-center","h-[80svh]"],["pd-prompts-list","",1,"px-6","py-6",3,"prompts"],[1,"relative","inline-flex","mb-2"],[1,"flex","size-5"],[1,"absolute","inline-flex","h-full","w-full","animate-ping","rounded-full","bg-primary","opacity-75"],[1,"relative","inline-flex","size-5","rounded-full","bg-primary-light"],[1,"opacity-95"]],template:function(e,i){if(e&1){let a=k();l(0,"header",1),g("open",function(){b(a);let y=$(2);return _(y.show())}),p(),l(1,"div",2,0),h(3,"pd-nav-menu"),p(),D(4,Ie,2,1,"div",3)(5,Ae,9,0,"div",4)}e&2&&(n(4),T(i.persistService.prompts().length>0?4:5))},dependencies:[q,pe,ae,fe],encapsulation:2})};var Fe=(r,t)=>t.key;function ze(r,t){if(r&1){let e=k();l(0,"ul",2)(1,"li",3),g("valueChange",function(a){b(e);let o=f();return _(o.updateField("titulo",a))}),p(),l(2,"li",4),g("valueChange",function(a){b(e);let o=f();return _(o.updateField("prompt",a))}),p(),l(3,"li",5),g("valueChange",function(a){b(e);let o=f();return _(o.updateField("descripcion",a))}),p(),l(4,"li",6),g("valueChange",function(a){b(e);let o=f();return _(o.updateField("categoria",a))}),p(),l(5,"li",7),g("valueChange",function(a){b(e);let o=f();return _(o.updateTags(a))}),p(),h(6,"li",8)(7,"li",9)(8,"li",10),p()}if(r&2){let e=f();n(),s("value",e.prompt().titulo),n(),s("value",e.prompt().prompt)("fieldType",e.getFieldType("prompt"))("maxLength",400),n(),s("value",e.prompt().descripcion),n(),s("value",e.prompt().categoria)("selectOptions",e.availableCategories()),n(),s("value",e.prompt().tags),n(),s("value",e.prompt().autor),n(),s("value",e.prompt().fecha_creacion),n(),s("value",e.prompt().id)}}function Ve(r,t){if(r&1&&h(0,"li",11),r&2){let e=t.$implicit,i=f(2);s("label",e.label)("value",i.prompt()[e.key])}}function Re(r,t){if(r&1&&(l(0,"ul",2),w(1,Ve,1,2,"li",11,Fe),p()),r&2){let e=f();n(),M(e.displayProperties)}}var _e=class r{notificationService=m(H);persistService=m(E);adminService=m(re);url=x(window.location.href);route=m(A);router=m(N);data=j(this.route.data);copyService=m(ie);prompt=C(()=>this.data().prompt);isAdmin$=this.adminService.isCurrentUserAdmin();availableCategories=C(()=>this.persistService.categories().map(t=>t.name));displayProperties=[{label:"T\xEDtulo",key:"titulo"},{label:"Texto",key:"prompt"},{label:"Descripci\xF3n",key:"descripcion"},{label:"Autor",key:"autor"},{label:"Categor\xEDa",key:"categoria"},{label:"Creado",key:"fecha_creacion"},{label:"Etiquetas",key:"tags"},{label:"ID",key:"id"}];constructor(t){t.setTitle(`${this.prompt().titulo} | Prompter`)}onDelete(t){t.stopPropagation(),this.persistService.deletePrompt(this.prompt().id),this.notificationService.success("Prompt eliminado"),this.router.navigate(["/"])}onCopyPrompt(t){t.stopPropagation(),this.copyService.copy(this.prompt().prompt)}async onShare(t){if(t.stopPropagation(),!navigator.canShare){this.copyService.copy(this.url());return}let e=this.prompt(),i=this.url(),a={title:"Prompter",text:e.titulo,url:i};if(navigator.canShare(a))try{await navigator.share(a)}catch(o){console.warn("Error al compartir el prompt:",o)}else this.copyService.copy(this.url())}async updateField(t,e){try{let i=this.prompt().id,a={[t]:e};await this.persistService.updatePrompt(i,a),this.notificationService.success(`${t} actualizado`)}catch(i){this.notificationService.error(`Error al actualizar ${t}`),console.error("Error updating field:",i)}}async updateTags(t){try{let e=t.split(",").map(i=>i.trim()).filter(i=>i.length>0);await this.updateField("tags",e)}catch(e){this.notificationService.error("Error al actualizar etiquetas"),console.error("Error updating tags:",e)}}getFieldType(t){let e=this.prompt().prompt?.length||0;return t==="prompt"?e<=400?"textarea":"text":t==="descripcion"?"textarea":t==="categoria"?"select":"text"}static \u0275fac=function(e){return new(e||r)(R(L))};static \u0275cmp=v({type:r,selectors:[["pd-prompt-detail"]],hostAttrs:[1,"w-full"],decls:5,vars:4,consts:[["pd-detail-header","",3,"delete","copyPrompt","share","titulo"],[1,"px-6","py-6","w-full"],[1,"divide-y-[0.5px]","divide-gray-500/50","space-y-2"],["pd-editable-field","","label","T\xEDtulo","fieldType","text",3,"valueChange","value"],["pd-editable-field","","label","Texto del Prompt",3,"valueChange","value","fieldType","maxLength"],["pd-editable-field","","label","Descripci\xF3n","fieldType","textarea",3,"valueChange","value"],["pd-editable-field","","label","Categor\xEDa","fieldType","select",3,"valueChange","value","selectOptions"],["pd-editable-field","","label","Etiquetas","fieldType","text",3,"valueChange","value"],["pd-key-value-item","","label","Autor",3,"value"],["pd-key-value-item","","label","Creado",3,"value"],["pd-key-value-item","","label","ID",3,"value"],["pd-key-value-item","",3,"label","value"]],template:function(e,i){e&1&&(l(0,"header",0),g("delete",function(o){return i.onDelete(o)})("copyPrompt",function(o){return i.onCopyPrompt(o)})("share",function(o){return i.onShare(o)}),p(),l(1,"div",1),D(2,ze,9,11,"ul",2),Y(3,"async"),K(4,Re,3,0,"ul",2),p()),e&2&&(s("titulo",i.prompt().titulo),n(2),T(Z(3,2,i.isAdmin$)?2:4))},dependencies:[oe,ce,ne,ee],encapsulation:2})};var xe=class r{notificationService=m(H);router=m(N);route=m(A);persist=m(E);data=j(this.route.data);prompts=C(()=>this.data().item.prompts);titulo=C(()=>this.data().item.name);subtitulo=C(()=>this.resolvedSubtitulo(this.prompts().length,this.data().type.lowercase));borrable=C(()=>this.prompts().length<=0);constructor(t){t.setTitle(`${this.data()?.item.name} | ${this.data()?.type.title} | Prompter`)}async onDelete(t){t.stopPropagation(),this.borrable()&&(this.data()?.type.lowercase==="etiqueta"?this.persist.deleteTag(this.data()?.item.name).then(()=>{this.notificationService.success("Etiqueta eliminada."),this.router.navigate(["/"])}):this.persist.deleteCategory(this.data()?.item.name).then(()=>{this.notificationService.success("Categor\xEDa eliminada."),this.router.navigate(["/"])}))}resolvedSubtitulo(t,e){return`${t===0?"Ning\xFAn prompt asociado":t===1?"1 prompt asociado":`${t.toFixed(0)} prompts asociados`} a esta ${e}`}static \u0275fac=function(e){return new(e||r)(R(L))};static \u0275cmp=v({type:r,selectors:[["pd-prompts"]],hostAttrs:[1,"w-full"],decls:3,vars:4,consts:[["pd-section-header","",3,"delete","titulo","subtitulo","enabled"],[1,"flex","flex-row","w-full"],["pd-prompts-list","",1,"p-4",3,"prompts"]],template:function(e,i){e&1&&(l(0,"header",0),g("delete",function(o){return i.onDelete(o)}),p(),l(1,"div",1),h(2,"ul",2),p()),e&2&&(s("titulo",i.titulo())("subtitulo",i.subtitulo())("enabled",i.borrable()),n(2),s("prompts",i.prompts()))},dependencies:[q,se],encapsulation:2})};var $e=(r,t)=>["/",r,t],Le=(r,t)=>t.id;function He(r,t){if(r&1&&(l(0,"li",2)(1,"a",3),h(2,"pd-highlighted-text",4)(3,"pd-highlighted-text",5)(4,"pd-highlighted-text",6),p()()),r&2){let e=t.$implicit,i=f();n(),s("routerLink",X(4,$e,i.promptUrl,e.originalItem.slug)),n(),s("textData",e.titulo),n(),s("textData",e.prompt),n(),s("textData",e.descripcion)}}var Se=class r{longitud=50;route=m(A);router=m(N);persistService=m(E);emptySearch=[];currentSearchTerm=x("");promptUrl="prompt";allSearchResults=x([]);initSearch=x("");ngOnInit(){this.route.queryParams.pipe(J(t=>t.search),G(t=>t.search)).subscribe(t=>{this.initSearch.set(t)})}onSearch(t){if(this.router.navigate([],{relativeTo:this.route,queryParams:{search:t.trim()},queryParamsHandling:"merge"}),t.length===0){this.allSearchResults.set(this.emptySearch),this.currentSearchTerm.set("");return}this.currentSearchTerm.set(t);let e=this.persistService.search(t);if(e.found.length===0){this.allSearchResults.set([]);return}let i=e.found.map(a=>{let o={id:a.item.id,titulo:{parts:[],in:-1},prompt:{parts:[],in:-1},descripcion:{parts:[],in:-1},autor:{parts:[],in:-1},matchType:a.relevanceScore===1?"exact":"fuzzy",matchScore:a.relevanceScore,originalItem:a.item};if(t.length>0&&a.foundIn!=="tags"&&a.foundIn!=="categoria"){let y=ue(a.item[a.foundIn],t,this.longitud);o[a.foundIn]={parts:y.parts,in:y.highlightIndex}}return this.fillEmptyFields(o,a.item),o});this.allSearchResults.set(i)}fillEmptyFields(t,e){t.titulo.parts.length===0&&(t.titulo={parts:[e.titulo.slice(0,this.longitud)],in:-1}),t.prompt.parts.length===0&&(t.prompt={parts:[e.prompt.slice(0,this.longitud)],in:-1}),t.descripcion.parts.length===0&&(t.descripcion={parts:[`${e.descripcion.slice(0,this.longitud)}...`],in:-1})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=v({type:r,selectors:[["pd-searching"]],decls:4,vars:1,consts:[["pd-search-header","",3,"search","term"],[1,"divide-y-[0.5px]","divide-gray-500/50","px-6","py-4"],[1,"overflow-x-hidden","py-2","w-full","group"],[1,"opacity-90","group-hover:opacity-100","transition-opacity",3,"routerLink"],[1,"text-primary-dark","font-titulo","text-sm/5",3,"textData"],[1,"font-merri","italic",3,"textData"],[1,"text-sm/5",3,"textData"]],template:function(e,i){e&1&&(l(0,"header",0),g("search",function(o){return i.onSearch(o)}),p(),l(1,"ul",1),w(2,He,5,7,"li",2,Le),p()),e&2&&(s("term",i.initSearch()),n(2),M(i.allSearchResults()))},dependencies:[le,de,te],encapsulation:2})};export{he as AdminPage,ye as CreatePromptPage,be as Home,_e as PromptDetail,xe as Prompts,Se as Searching};
