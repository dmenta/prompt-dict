import{A as J,B as p,Ba as pe,C as u,D as F,E as _,Ea as P,F as x,Fa as c,G as m,Ga as T,H as o,Ha as k,I as n,Ia as M,J as s,Ja as L,K,Ka as I,L as w,La as ue,M as h,Ma as ce,N as W,Na as fe,Oa as ge,P as a,Pa as q,Q as N,Qa as V,R as X,S as Y,T as Z,U as ee,V as te,X as ie,Y as re,Ya as ve,Z as ne,_ as b,ba as oe,ca as ae,d as B,da as le,j as C,ja as me,k as R,ka as se,l as j,n as g,na as de,q as l,s as v,u as U,v as Q,y as z,ya as A,z as H}from"./chunk-KB2QL4NB.js";var xe=()=>[import("./chunk-266F6YOL.js").then(e=>e.DisplayPrompt)],he=(e,i)=>i.id;function Ne(e,i){if(e&1&&s(0,"li",0),e&2){let t=h().$implicit;m("prompt",t),J("tabindex",1)}}function Se(e,i){e&1&&s(0,"li",1)}function we(e,i){e&1&&(Q(0,Ne,1,2)(1,Se,1,0),z(2,0,xe,null,1),H(0,-1))}var be=class e{prompts=b([]);static \u0275fac=function(t){return new(t||e)};static \u0275cmp=v({type:e,selectors:[["pd-prompts-list"],["","pd-prompts-list",""]],hostAttrs:[1,"flex","flex-col","md:flex-row","flex-wrap","h-full","w-full","gap-6"],inputs:{prompts:[1,"prompts"]},decls:2,vars:0,consts:[["pd-display-prompt","",3,"prompt"],[1,"h-48","select-none","md:min-w-[16rem]","md:w-[24rem]","md:max-w-[36rem]","grow-1","relative","inline-block","group","px-2","py-4","shadow-md/30","shadow-black/40","dark:shadow-black/80","bg-card","hover:bg-card-hover","dark:hover:bg-card-hover/30","transition-colors","duration-150"]],template:function(t,r){t&1&&_(0,we,4,0,null,null,he),t&2&&x(r.prompts())},encapsulation:2})};var De=(e,i)=>i.value;function Fe(e,i){e&1&&(o(0,"div",4),a(1,"Campo obligatorio"),n())}function Ae(e,i){e&1&&(o(0,"div",4),a(1,"Campo obligatorio"),n())}function Pe(e,i){e&1&&(o(0,"div",4),a(1,"Campo obligatorio"),n())}function Te(e,i){if(e&1&&s(0,"option",9),e&2){let t=i.$implicit;m("value",t)}}function ke(e,i){e&1&&(o(0,"div",4),a(1,"Campo obligatorio"),n())}function Me(e,i){if(e&1&&s(0,"option",9),e&2){let t=i.$implicit;m("value",t)}}function Le(e,i){if(e&1&&_(0,Me,1,1,"option",9,F),e&2){let t=h();x(t.tags())}}function Ie(e,i){e&1&&(o(0,"div",4),a(1,"Campo obligatorio"),n())}function qe(e,i){e&1&&(o(0,"div",4),a(1,"Campo obligatorio"),n())}function Ve(e,i){if(e&1&&(o(0,"option",15),a(1),ee(2,"titlecase"),n()),e&2){let t=i.$implicit;m("value",t),l(),N(te(2,2,t))}}function Ge(e,i){if(e&1&&(o(0,"option",9),a(1),n()),e&2){let t=i.$implicit;m("value",t.value),l(),N(t.label)}}function Oe(e,i){e&1&&s(0,"span",18)}var ye=class e{notificationService=C(de);isSubmitting=g(!1);formBuilder=C(q);appData=C(A);usoOptions=["texto","c\xF3digo","imagen","video","audio","otro"];idiomaOptions=[{value:"es-AR",label:"Espa\xF1ol (Argentina)"},{value:"EN",label:"English"}];categorias=g([]);tags=g([]);form=this.formBuilder.nonNullable.group({titulo:["",[c.required,this.trimValidator]],descripcion:["",c.required,this.trimValidator],autor:["",[c.required,this.trimValidator]],categoria:["",[c.required,this.trimValidator]],tags:[[],[c.required]],prompt:["",[c.required,this.trimValidator]],uso:["texto",[c.required]],idioma:["es-AR",[c.required]]});valid=this.form.statusChanges.pipe(B(i=>i==="VALID"));submiting=ne();async trimValidator(i){return typeof i.value=="string"&&i.value.trim().length===0?{trim:!0}:null}constructor(){this.appData.categories().subscribe(i=>this.categorias.set([...i.map(t=>t.name)])),this.appData.tags().subscribe(i=>this.tags.set([...i.map(t=>t.name)]))}async onSubmit(i){if(i.stopPropagation(),!(this.form.invalid||this.isSubmitting())){this.submiting.emit(!0),this.isSubmitting.set(!0);try{let t=this.form.value,r=t.categoria.trim().toLowerCase(),d=typeof t.tags=="string"?t.tags.split(",").map(f=>f.trim().toLowerCase()).filter(f=>f):Array.isArray(t.tags)?t.tags.map(f=>f.trim().toLowerCase()):[],S={titulo:t.titulo.trim(),descripcion:t.descripcion.trim(),autor:t.autor.trim(),categoria:r,tags:d,prompt:t.prompt.trim(),uso:t.uso,idioma:t.idioma};await this.appData.createPrompt(S),this.form.reset(),this.notificationService.success("Prompt creado")}finally{this.isSubmitting.set(!1),this.submiting.emit(!1)}}}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=v({type:e,selectors:[["pd-create-prompt-form"]],outputs:{valid:"valid",submiting:"submiting"},decls:54,vars:10,consts:[[1,"flex","justify-center","items-start","text-sm","w-full","min-h-[80vh]","px-6","py-8"],[1,"w-full","max-w-xl","rounded-xl","space-y-6",3,"ngSubmit","formGroup"],[1,"block","mb-1","text-inverse-low"],["formControlName","titulo","type","text",1,"w-full","px-4","py-2","rounded-lg","border","border-neutral-300","dark:border-neutral-700","focus:outline-none","focus:ring-2","focus:ring-primary","transition"],[1,"text-red-400","text-xs","mt-1"],["formControlName","descripcion","rows","2",1,"w-full","px-4","py-2","rounded-lg","border","border-neutral-300","dark:border-neutral-700","focus:outline-none","focus:ring-2","focus:ring-primary","transition"],["formControlName","autor","autocomplete","name","type","text",1,"w-full","px-4","py-2","rounded-lg","border","border-neutral-300","dark:border-neutral-700","focus:outline-none","focus:ring-2","focus:ring-primary","transition"],["formControlName","categoria","type","text","list","cat-list","autocomplete","off",1,"w-full","px-4","py-2","rounded-lg","border","border-neutral-300","dark:border-neutral-700","focus:outline-none","focus:ring-2","focus:ring-primary","transition"],["id","cat-list"],[3,"value"],["formControlName","tags","type","text","list","tags-list","placeholder","","autocomplete","off",1,"w-full","px-4","py-2","rounded-lg","border","border-neutral-300","dark:border-neutral-700","focus:outline-none","focus:ring-2","focus:ring-primary","transition"],["id","tags-list"],[1,"text-xs","text-neutral-500","dark:text-neutral-400","mt-1"],["formControlName","prompt","rows","3",1,"w-full","px-4","py-2","rounded-lg","border","border-neutral-300","dark:border-neutral-700","focus:outline-none","focus:ring-2","focus:ring-primary","transition"],["formControlName","uso",1,"w-full","px-4","py-2","rounded-lg","border","border-neutral-300","dark:border-neutral-700","focus:outline-none","focus:ring-2","focus:ring-primary","transition"],[1,"appearance-none",3,"value"],["formControlName","idioma",1,"w-full","px-4","py-2","rounded-lg","border","border-neutral-300","dark:border-neutral-700","focus:outline-none","focus:ring-2","focus:ring-primary","transition"],["type","submit",1,"w-full","hidden","md:flex","bg-primary","text-white","rounded-lg","px-6","py-2","font-semibold","shadow","hover:bg-primary-dark","transition","disabled:opacity-60","items-center","justify-center","gap-2",3,"disabled"],[1,"spinner"]],template:function(t,r){if(t&1&&(o(0,"div",0)(1,"form",1),w("ngSubmit",function(y){return r.onSubmit(y)}),o(2,"div")(3,"label",2),a(4,"T\xEDtulo *"),n(),s(5,"input",3),p(6,Fe,2,0,"div",4),n(),o(7,"div")(8,"label",2),a(9,"Descripci\xF3n *"),n(),s(10,"textarea",5),p(11,Ae,2,0,"div",4),n(),o(12,"div")(13,"label",2),a(14,"Autor *"),n(),s(15,"input",6),p(16,Pe,2,0,"div",4),n(),o(17,"div")(18,"label",2),a(19,"Categor\xEDa *"),n(),s(20,"input",7),o(21,"datalist",8),_(22,Te,1,1,"option",9,F),n(),p(24,ke,2,0,"div",4),n(),o(25,"div")(26,"label",2),a(27,"Tags"),n(),s(28,"input",10),o(29,"datalist",11),p(30,Le,2,0),n(),o(31,"div",12),a(32," Separados por coma "),n(),p(33,Ie,2,0,"div",4),n(),o(34,"div")(35,"label",2),a(36,"Prompt *"),n(),s(37,"textarea",13),p(38,qe,2,0,"div",4),n(),o(39,"div")(40,"label",2),a(41,"Uso"),n(),o(42,"select",14),_(43,Ve,3,4,"option",15,F),n()(),o(45,"div")(46,"label",2),a(47,"Idioma"),n(),o(48,"select",16),_(49,Ge,2,2,"option",9,De),n()(),o(51,"button",17),a(52," Guardar Prompt "),p(53,Oe,1,0,"span",18),n()()()),t&2){let d,y,S,f,E,D;l(),m("formGroup",r.form),l(5),u((d=r.form.get("titulo"))!=null&&d.invalid&&((d=r.form.get("titulo"))!=null&&d.touched)?6:-1),l(5),u((y=r.form.get("descripcion"))!=null&&y.invalid&&((y=r.form.get("descripcion"))!=null&&y.touched)?11:-1),l(5),u((S=r.form.get("autor"))!=null&&S.invalid&&((S=r.form.get("autor"))!=null&&S.touched)?16:-1),l(6),x(r.categorias()),l(2),u((f=r.form.get("categoria"))!=null&&f.invalid&&((f=r.form.get("categoria"))!=null&&f.touched)?24:-1),l(6),u(r.form.controls.tags.value.length>1?30:-1),l(3),u((E=r.form.get("tags"))!=null&&E.invalid&&((E=r.form.get("tags"))!=null&&E.touched)?33:-1),l(5),u((D=r.form.get("prompt"))!=null&&D.invalid&&((D=r.form.get("prompt"))!=null&&D.touched)?38:-1),l(5),x(r.usoOptions),l(6),x(r.idiomaOptions),l(2),m("disabled",r.form.invalid||r.isSubmitting()),l(2),u(r.isSubmitting()?53:-1)}},dependencies:[V,M,ce,fe,P,ue,T,k,L,I,ae],encapsulation:2})};var lt={category:{title:"Categor\xEDa",lowercase:"categor\xEDa"},tag:{title:"Etiqueta",lowercase:"etiqueta"}};var $e=["pd-nav-item",""],Be=(e,i)=>[e,i],Re=e=>({name:e}),$=class e{paramName=b(null);slug=b(null);name=b("");cantidad=b(0);static \u0275fac=function(t){return new(t||e)};static \u0275cmp=v({type:e,selectors:[["","pd-nav-item",""]],hostAttrs:[1,"w-full","block"],inputs:{paramName:[1,"paramName"],slug:[1,"slug"],name:[1,"name"],cantidad:[1,"cantidad"]},attrs:$e,decls:6,vars:10,consts:[["rla","routerLinkActive"],["routerLinkActive","",1,"select-none",3,"routerLink","state"],[1,"inline-flex","items-center","whitespace-nowrap","rounded-md","font-regular","ring-offset-background","transition-colors","focus-visible:outline-none","focus-visible:ring-2","focus-visible:ring-ring","focus-visible:ring-offset-2","disabled:pointer-events-none","text-sm","disabled:opacity-50","hover:bg-item-hover","hover:text-item-hover-contrast","h-10","px-4","py-8","md:py-4","w-full","gap-2",3,"disabled"],[3,"quantity"]],template:function(t,r){if(t&1&&(o(0,"a",1,0)(2,"button",2),s(3,"pd-quantity-bagde",3),o(4,"span"),a(5),n()()()),t&2){let d=W(1);m("routerLink",Z(5,Be,r.paramName(),r.slug()))("state",Y(8,Re,r.name())),l(2),m("disabled",d.isActive),l(),m("quantity",r.cantidad()),l(2),X(" ",r.name())}},dependencies:[me,se,ve],encapsulation:2})};var je=["pd-nav-list",""],Ue=(e,i)=>i.slug;function Qe(e,i){if(e&1&&s(0,"li",0),e&2){let t=i.$implicit,r=h();m("slug",t.slug)("name",t.name)("paramName",r.list())("cantidad",t.prompt_count)}}var Ce=class e{persistService=C(A);list=b("category");sort=b("qty");items=g([]);sortedItems=ie(()=>this.items().sort((i,t)=>this.sort()==="qty"?t.prompt_count-i.prompt_count:i.name.localeCompare(t.name)));constructor(){re(()=>{this.list()==="category"?this.persistService.categories().subscribe(i=>{this.items.set(i)}):this.persistService.tags().subscribe(i=>{this.items.set(i)})})}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=v({type:e,selectors:[["nav","pd-nav-list",""],["ul","pd-nav-list",""],["ol","pd-nav-list",""]],hostAttrs:[1,"space-y-1","w-full","h-full"],inputs:{list:[1,"list"],sort:[1,"sort"]},attrs:je,decls:2,vars:0,consts:[["pd-nav-item","",3,"slug","name","paramName","cantidad"]],template:function(t,r){t&1&&_(0,Qe,1,4,"li",0,Ue),t&2&&x(r.sortedItems())},dependencies:[$],encapsulation:2})};function ze(e,i){if(e&1&&(o(0,"div",6),a(1),n()),e&2){let t=h();l(),N(t.error())}}function He(e,i){e&1&&(o(0,"div"),a(1,"Cargando..."),n())}function Je(e,i){if(e&1){let t=K();o(0,"tr")(1,"td"),a(2),n(),o(3,"td",10),a(4),n(),o(5,"td")(6,"button",11),w("click",function(){let d=R(t).$implicit,y=h();return j(y.removeAdmin(d.uid))}),a(7," Eliminar "),n()()()}if(e&2){let t=i.$implicit;l(2),N(t.email||"(sin email)"),l(2),N(t.uid)}}var _e=class e{adminService=C(pe);fb=C(q);admins=g([]);isLoading=g(!1);error=g(null);form=this.fb.group({uid:["",[c.required]],email:["",[c.email]]});constructor(){this.loadAdmins()}async loadAdmins(){this.isLoading.set(!0),this.error.set(null);try{this.admins.set(await this.adminService.getAdmins())}catch(i){this.error.set(i.message||"Error al cargar admins")}finally{this.isLoading.set(!1)}}async addAdmin(){if(!this.form.invalid){this.isLoading.set(!0);try{await this.adminService.addAdminByUid(this.form.value.uid,this.form.value.email||void 0),this.form.reset(),await this.loadAdmins()}catch(i){this.error.set(i.message||"Error al agregar admin")}finally{this.isLoading.set(!1)}}}async removeAdmin(i){this.isLoading.set(!0);try{await this.adminService.removeAdmin(i),await this.loadAdmins()}catch(t){this.error.set(t.message||"Error al eliminar admin")}finally{this.isLoading.set(!1)}}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=v({type:e,selectors:[["pd-admin-management"]],decls:21,vars:5,consts:[[1,"max-w-xl","mx-auto","p-6","bg-white","dark:bg-neutral-900","rounded-xl","shadow","border","border-neutral-200","dark:border-neutral-800","mt-8"],[1,"text-lg","font-semibold","mb-4"],[1,"flex","gap-2","mb-6",3,"ngSubmit","formGroup"],["formControlName","uid","type","text","placeholder","UID del nuevo admin","required","",1,"flex-1","px-3","py-2","rounded","border","border-neutral-300","dark:border-neutral-700","bg-white","dark:bg-neutral-800"],["formControlName","email","type","email","placeholder","Email (opcional, solo referencia)",1,"flex-1","px-3","py-2","rounded","border","border-neutral-300","dark:border-neutral-700","bg-white","dark:bg-neutral-800"],["type","submit",1,"bg-primary","text-white","px-4","py-2","rounded","disabled:opacity-60",3,"disabled"],[1,"text-red-600","mb-2"],[1,"w-full","text-sm"],[1,"text-left","border-b","border-neutral-200","dark:border-neutral-700"],[4,"ngFor","ngForOf"],[1,"font-mono","text-xs"],[1,"text-red-600","hover:underline",3,"click"]],template:function(t,r){t&1&&(o(0,"div",0)(1,"h2",1),a(2,"Administradores"),n(),o(3,"form",2),w("ngSubmit",function(){return r.addAdmin()}),s(4,"input",3)(5,"input",4),o(6,"button",5),a(7," Agregar "),n()(),p(8,ze,2,1,"div",6),p(9,He,2,0,"div"),o(10,"table",7)(11,"thead")(12,"tr",8)(13,"th"),a(14,"Email"),n(),o(15,"th"),a(16,"UID"),n(),o(17,"th"),a(18,"Acciones"),n()()(),o(19,"tbody"),U(20,Je,8,2,"tr",9),n()()()),t&2&&(l(3),m("formGroup",r.form),l(3),m("disabled",r.form.invalid||r.isLoading()),l(2),u(r.error()?8:-1),l(),u(r.isLoading()?9:-1),l(11),m("ngForOf",r.admins()))},dependencies:[le,oe,V,M,P,T,k,ge,L,I],encapsulation:2})};export{be as a,ye as b,lt as c,Ce as d,_e as e};
