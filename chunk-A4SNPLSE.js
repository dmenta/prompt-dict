import{$ as I,B as _,E as C,I as E,R as $,W as q,b as y,g,h as o,i as F,m as h,n as d,o as u,p as l,q as n,r as p,s as S,u as b,v,y as m,z as f}from"./chunk-QIJJGTYP.js";var x=r=>({"dark:bg-[#FFFF0060] bg-[#FFFF00]":r}),T=(r,e)=>e.id;function w(r,e){if(r&1&&(n(0,"span",8),m(1),p()),r&2){let t=e.$implicit,i=e.$index,a=v().$implicit;l("ngClass",_(2,x,i===a.titulo.in)),o(),f(t)}}function M(r,e){if(r&1&&(n(0,"span",8),m(1),p()),r&2){let t=e.$implicit,i=e.$index,a=v().$implicit;l("ngClass",_(2,x,i===a.prompt.in)),o(),f(t)}}function N(r,e){if(r&1&&(n(0,"span",8),m(1),p()),r&2){let t=e.$implicit,i=e.$index,a=v().$implicit;l("ngClass",_(2,x,i===a.descripcion.in)),o(),f(t)}}function A(r,e){if(r&1&&(n(0,"li",6)(1,"div",7),d(2,w,2,4,"span",8,h),p(),n(4,"div",7),d(5,M,2,4,"span",8,h),p(),n(7,"div",7),d(8,N,2,4,"span",8,h),p()()),r&2){let t=e.$implicit;o(2),u(t.titulo.parts),o(3),u(t.prompt.parts),o(3),u(t.descripcion.parts)}}var D=class r{longitud=40;mediaLongitud=this.longitud/2;persistService=y(q);todasLasEtiquetas=this.persistService.tags();todasLasCategorias=this.persistService.categories();etiquetas=g([]);categorias=g([]);prompts=g([]);etiquetasActuales=C(()=>this.todasLasEtiquetas.map(e=>({id:e.slug,name:e.text,activa:this.etiquetas().length!==this.todasLasEtiquetas.length&&this.etiquetas().includes(e.text)})).sort((e,t)=>(e.activa===!0?0:1)-(t.activa===!0?0:1)||e.name.localeCompare(t.name)));categoriasActuales=C(()=>this.todasLasCategorias.map(e=>({id:e.slug,name:e.text,activa:this.categorias().length!==this.todasLasCategorias.length&&this.categorias().includes(e.text)})).sort((e,t)=>(e.activa===!0?0:1)-(t.activa===!0?0:1)||e.name.localeCompare(t.name)));onSearch(e){let t=this.persistService.search(e);if(t.found.length===0){this.etiquetas.set([]),this.categorias.set([]),this.prompts.set([]);return}let i=t.found.map(a=>{let s={id:a.item.id,titulo:{parts:[],in:-1},prompt:{parts:[],in:-1},descripcion:{parts:[],in:-1},autor:{parts:[],in:-1},categoria:{parts:[],in:-1},tags:[]};return e.length>0&&(a.foundIn!=="tags"?s[a.foundIn]=this.relevantSection(a.item[a.foundIn],a.position,e.length):s.tags=a.item.tags.filter(c=>t.etiquetas.includes(c.toLowerCase()))),s.titulo.parts.length===0&&(s.titulo={parts:[`${a.item.titulo.slice(0,this.longitud)}`],in:-1}),s.prompt.parts.length===0&&(s.prompt={parts:[`${a.item.prompt.slice(0,this.longitud)}`],in:-1}),s.descripcion.parts.length===0&&(s.descripcion={parts:[`${a.item.descripcion.slice(0,this.longitud)}...`],in:-1}),s});this.etiquetas.set(t.etiquetas),this.categorias.set(t.categorias),this.prompts.set(i)}relevantSection(e,t,i){let a=t-this.mediaLongitud,s=t+i+this.mediaLongitud,c=e.slice(t,t+i);return t<=0?{parts:[c,e.slice(t+i,this.longitud)],in:0}:t+i>=e.length?{parts:[e.slice(-this.longitud,-i),c],in:1}:a<0?{parts:[e.slice(0,t),c,e.slice(t+i,this.longitud)],in:1}:s>e.length?{parts:[e.slice(Math.max(0,e.length-this.longitud),t),c,e.slice(t+i)],in:1}:{parts:[e.slice(a,t),c,e.slice(t+i,s)],in:1}}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=F({type:r,selectors:[["pd-searching"]],decls:12,vars:2,consts:[["pd-search-header","",3,"search"],[1,"px-6","py-4","overflow-hidden"],[1,"py-2"],[3,"items"],[1,"py-6","w-full"],[1,"divide-y-[0.5px]","divide-gray-500","space-y-2"],[1,"flex","flex-col","pt-1","pb-3","items-start","justify-center"],[1,"whitespace-nowrap","flex","flex-row","justify-start","items-center"],[1,"text-lg","whitespace-pre",3,"ngClass"]],template:function(t,i){t&1&&(n(0,"header",0),b("search",function(s){return i.onSearch(s)}),p(),n(1,"div",1)(2,"h4",2),m(3,"Categor\xEDas"),p(),S(4,"pd-chips-list",3),n(5,"h4",2),m(6,"Etiquetas"),p(),S(7,"pd-chips-list",3),n(8,"div",4)(9,"ul",5),d(10,A,10,0,"li",6,T),p()()()),t&2&&(o(4),l("items",i.categoriasActuales()),o(3),l("items",i.etiquetasActuales()),o(3),u(i.prompts()))},dependencies:[I,E,$],encapsulation:2})};export{D as Searching};
