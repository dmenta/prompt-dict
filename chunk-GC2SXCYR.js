import{$ as q,$a as ae,E as f,F as g,Fa as U,Ga as z,H as E,I as h,Ia as J,J as S,K as d,L as n,La as K,M as o,Ma as Q,N as s,Oa as W,Pa as X,Qa as Y,R as H,Ra as Z,S as v,Sa as b,Ta as ee,U as A,Ua as te,Wa as ie,Ya as oe,Za as re,_ as I,_a as ne,aa as l,ab as le,ba as M,bb as me,ca as G,cb as pe,d as V,ga as O,ha as L,l as _,la as T,m as P,ma as D,n as k,p as C,pa as R,s as a,ua as $,v as y,x as B,za as j}from"./chunk-SS37W63O.js";var F=class t{apply=T();waiting=D(!1);enabled=D(!0);router=_($);titulo=D("Tarea");onBack(e){e.stopPropagation(),this.router.navigate(["/"])}onTaskButtonClicked(e){e.stopPropagation(),this.apply.emit()}static \u0275fac=function(r){return new(r||t)};static \u0275cmp=y({type:t,selectors:[["pd-task-header"]],inputs:{waiting:[1,"waiting"],enabled:[1,"enabled"],titulo:[1,"titulo"]},outputs:{apply:"apply"},features:[B([Q])],decls:7,vars:5,consts:[["pdHeaderContent",""],["pdHeaderRow","",1,""],["pdHeaderBackButton","",3,"back"],["pdTruncate","",1,"text-header-contrast","text-2xl",3,"title"],[1,"spinner"],["pdHeaderActionButton","","title","Aceptar","aria-label","Aceptar","pdIcon","check",1,"mr-2","disabled:pointer-events-none","md:hidden","disabled:bg-neutral-500","dark:disabled:bg-neutral-600","transition-colors","duration-300",3,"click","disabled"]],template:function(r,i){r&1&&(n(0,"div",0)(1,"div",1)(2,"button",2),v("back",function(m){return i.onBack(m)}),o(),n(3,"h1",3),l(4),o(),s(5,"div",4),n(6,"button",5),v("click",function(m){return i.onTaskButtonClicked(m)}),o()()()),r&2&&(a(3),d("title",i.titulo()),a(),G(" ",i.titulo()," "),a(),q("spinner-show",i.waiting()),a(),d("disabled",!i.enabled()||i.waiting()))},dependencies:[K,Y,W,X,z,J],encapsulation:2})};var ce=(t,e)=>e.value;function fe(t,e){t&1&&(n(0,"div",4),l(1,"Campo obligatorio"),o())}function ge(t,e){t&1&&(n(0,"div",4),l(1,"Campo obligatorio"),o())}function be(t,e){t&1&&(n(0,"div",4),l(1,"Campo obligatorio"),o())}function ve(t,e){if(t&1&&s(0,"option",9),t&2){let r=e.$implicit;d("value",r)}}function Ce(t,e){t&1&&(n(0,"div",4),l(1,"Campo obligatorio"),o())}function _e(t,e){if(t&1&&s(0,"option",9),t&2){let r=e.$implicit;d("value",r)}}function ye(t,e){if(t&1&&h(0,_e,1,1,"option",9,E),t&2){let r=A();S(r.tags())}}function he(t,e){t&1&&(n(0,"div",4),l(1,"Campo obligatorio"),o())}function Se(t,e){t&1&&(n(0,"div",4),l(1,"Campo obligatorio"),o())}function we(t,e){if(t&1&&(n(0,"option",15),l(1),O(2,"titlecase"),o()),t&2){let r=e.$implicit;d("value",r),a(),M(L(2,2,r))}}function xe(t,e){if(t&1&&(n(0,"option",9),l(1),o()),t&2){let r=e.$implicit;d("value",r.value),a(),M(r.label)}}function Pe(t,e){t&1&&s(0,"span",18)}var N=class t{notificationService=_(j);isSubmitting=C(!1);formBuilder=_(me);appData=_(U);usoOptions=["texto","c\xF3digo","imagen","video","audio","otro"];idiomaOptions=[{value:"es-AR",label:"Espa\xF1ol (Argentina)"},{value:"EN",label:"English"}];categorias=C([]);tags=C([]);form=this.formBuilder.nonNullable.group({titulo:["",[b.required,this.trimValidator]],descripcion:["",b.required,this.trimValidator],autor:["",[b.required,this.trimValidator]],categoria:["",[b.required,this.trimValidator]],tags:[[],[b.required]],prompt:["",[b.required,this.trimValidator]],uso:["texto",[b.required]],idioma:["es-AR",[b.required]]});valid=this.form.statusChanges.pipe(V(e=>e==="VALID"));submiting=T();async trimValidator(e){return typeof e.value=="string"&&e.value.trim().length===0?{trim:!0}:null}constructor(){this.appData.categories().then(e=>this.categorias.set([...e.map(r=>r.name)])),this.appData.tags().then(e=>this.tags.set([...e.map(r=>r.name)]))}async submit(){this.submiting.emit(!0),await this.onSubmit().then(()=>{this.submiting.emit(!1)})}async onSubmit(){if(!(this.form.invalid||this.isSubmitting())){this.isSubmitting.set(!0);try{let e=this.form.value,r=e.categoria.trim().toLowerCase(),i=typeof e.tags=="string"?e.tags.split(",").map(c=>c.trim().toLowerCase()).filter(c=>c):Array.isArray(e.tags)?e.tags.map(c=>c.trim().toLowerCase()):[],m={titulo:e.titulo.trim(),descripcion:e.descripcion.trim(),autor:e.autor.trim(),categoria:r,tags:i,prompt:e.prompt.trim(),uso:e.uso,idioma:e.idioma},u=await this.appData.createPrompt(m);await this.appData.updateTagsAndCategory(i,r,!1),this.form.reset(),this.notificationService.success("Prompt creado")}finally{this.isSubmitting.set(!1)}}}static \u0275fac=function(r){return new(r||t)};static \u0275cmp=y({type:t,selectors:[["pd-create-prompt-form"]],outputs:{valid:"valid",submiting:"submiting"},decls:54,vars:10,consts:[[1,"flex","justify-center","items-start","text-sm","w-full","min-h-[80vh]","px-6","py-8"],[1,"w-full","max-w-xl","rounded-xl","space-y-6",3,"ngSubmit","formGroup"],[1,"block","mb-1","text-inverse-low"],["formControlName","titulo","type","text",1,"w-full","px-4","py-2","rounded-lg","border","border-neutral-300","dark:border-neutral-700","focus:outline-none","focus:ring-2","focus:ring-primary","transition"],[1,"text-red-400","text-xs","mt-1"],["formControlName","descripcion","rows","2",1,"w-full","px-4","py-2","rounded-lg","border","border-neutral-300","dark:border-neutral-700","focus:outline-none","focus:ring-2","focus:ring-primary","transition"],["formControlName","autor","autocomplete","name","type","text",1,"w-full","px-4","py-2","rounded-lg","border","border-neutral-300","dark:border-neutral-700","focus:outline-none","focus:ring-2","focus:ring-primary","transition"],["formControlName","categoria","type","text","list","cat-list","autocomplete","off",1,"w-full","px-4","py-2","rounded-lg","border","border-neutral-300","dark:border-neutral-700","focus:outline-none","focus:ring-2","focus:ring-primary","transition"],["id","cat-list"],[3,"value"],["formControlName","tags","type","text","list","tags-list","placeholder","","autocomplete","off",1,"w-full","px-4","py-2","rounded-lg","border","border-neutral-300","dark:border-neutral-700","focus:outline-none","focus:ring-2","focus:ring-primary","transition"],["id","tags-list"],[1,"text-xs","text-neutral-500","dark:text-neutral-400","mt-1"],["formControlName","prompt","rows","3",1,"w-full","px-4","py-2","rounded-lg","border","border-neutral-300","dark:border-neutral-700","focus:outline-none","focus:ring-2","focus:ring-primary","transition"],["formControlName","uso",1,"w-full","px-4","py-2","rounded-lg","border","border-neutral-300","dark:border-neutral-700","focus:outline-none","focus:ring-2","focus:ring-primary","transition"],[1,"appearance-none",3,"value"],["formControlName","idioma",1,"w-full","px-4","py-2","rounded-lg","border","border-neutral-300","dark:border-neutral-700","focus:outline-none","focus:ring-2","focus:ring-primary","transition"],["type","submit",1,"w-full","hidden","md:flex","bg-primary","text-white","rounded-lg","px-6","py-2","font-semibold","shadow","hover:bg-primary-dark","transition","disabled:opacity-60","items-center","justify-center","gap-2",3,"disabled"],[1,"spinner"]],template:function(r,i){if(r&1&&(n(0,"div",0)(1,"form",1),v("ngSubmit",function(){return i.onSubmit()}),n(2,"div")(3,"label",2),l(4,"T\xEDtulo *"),o(),s(5,"input",3),f(6,fe,2,0,"div",4),o(),n(7,"div")(8,"label",2),l(9,"Descripci\xF3n *"),o(),s(10,"textarea",5),f(11,ge,2,0,"div",4),o(),n(12,"div")(13,"label",2),l(14,"Autor *"),o(),s(15,"input",6),f(16,be,2,0,"div",4),o(),n(17,"div")(18,"label",2),l(19,"Categor\xEDa *"),o(),s(20,"input",7),n(21,"datalist",8),h(22,ve,1,1,"option",9,E),o(),f(24,Ce,2,0,"div",4),o(),n(25,"div")(26,"label",2),l(27,"Tags"),o(),s(28,"input",10),n(29,"datalist",11),f(30,ye,2,0),o(),n(31,"div",12),l(32," Separados por coma "),o(),f(33,he,2,0,"div",4),o(),n(34,"div")(35,"label",2),l(36,"Prompt *"),o(),s(37,"textarea",13),f(38,Se,2,0,"div",4),o(),n(39,"div")(40,"label",2),l(41,"Uso"),o(),n(42,"select",14),h(43,we,3,4,"option",15,E),o()(),n(45,"div")(46,"label",2),l(47,"Idioma"),o(),n(48,"select",16),h(49,xe,2,2,"option",9,ce),o()(),n(51,"button",17),l(52," Guardar Prompt "),f(53,Pe,1,0,"span",18),o()()()),r&2){let p,m,u,c,w,x;a(),d("formGroup",i.form),a(5),g((p=i.form.get("titulo"))!=null&&p.invalid&&((p=i.form.get("titulo"))!=null&&p.touched)?6:-1),a(5),g((m=i.form.get("descripcion"))!=null&&m.invalid&&((m=i.form.get("descripcion"))!=null&&m.touched)?11:-1),a(5),g((u=i.form.get("autor"))!=null&&u.invalid&&((u=i.form.get("autor"))!=null&&u.touched)?16:-1),a(6),S(i.categorias()),a(2),g((c=i.form.get("categoria"))!=null&&c.invalid&&((c=i.form.get("categoria"))!=null&&c.touched)?24:-1),a(6),g(i.form.controls.tags.value.length>1?30:-1),a(3),g((w=i.form.get("tags"))!=null&&w.invalid&&((w=i.form.get("tags"))!=null&&w.touched)?33:-1),a(5),g((x=i.form.get("prompt"))!=null&&x.invalid&&((x=i.form.get("prompt"))!=null&&x.touched)?38:-1),a(5),S(i.usoOptions),a(6),S(i.idiomaOptions),a(2),d("disabled",i.form.invalid||i.isSubmitting),a(2),g(i.isSubmitting()?53:-1)}},dependencies:[pe,ie,ae,le,Z,ne,ee,te,oe,re,R],encapsulation:2})};var ue=class t{enabled=C(!1);submitting=C(!1);static \u0275fac=function(r){return new(r||t)};static \u0275cmp=y({type:t,selectors:[["pd-create-prompt-page"]],decls:3,vars:2,consts:[["form",""],["titulo","Nuevo Prompt",3,"apply","enabled","waiting"],[3,"valid","submiting"]],template:function(r,i){if(r&1){let p=H();n(0,"pd-task-header",1),v("apply",function(){P(p);let u=I(2);return k(u.submit())}),o(),n(1,"pd-create-prompt-form",2,0),v("valid",function(u){return P(p),k(i.enabled.set(u))})("submiting",function(u){return P(p),k(i.submitting.set(u))}),o()}r&2&&d("enabled",i.enabled())("waiting",i.submitting())},dependencies:[F,N],encapsulation:2})};export{ue as CreatePromptPage};
