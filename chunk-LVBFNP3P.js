import{a as A,b as oe,c as F,d as ne,e as se}from"./chunk-Q5KSQTRT.js";import{$ as I,A as T,B as m,C as o,D as n,E as d,F as M,G as u,H as _,I as E,J as U,K as y,L as R,La as h,M as Z,Na as Q,O as B,Oa as W,S as f,a as q,aa as D,ab as X,b as j,bb as Y,c as V,ca as P,cb as ee,d as $,da as G,db as te,eb as ie,f as p,fb as re,h as b,ha as k,i as S,ia as J,ja as K,l as g,lb as ae,n as l,o as N,p as c,w as z,wa as L,x as O,z as w}from"./chunk-EL7QZYI6.js";var pe=class r{static \u0275fac=function(t){return new(t||r)};static \u0275cmp=c({type:r,selectors:[["pd-admin-page"]],decls:1,vars:0,template:function(t,i){t&1&&d(0,"pd-admin-management")},dependencies:[se],encapsulation:2})};var le=class r{enabled=g(!1);submitting=g(!1);static \u0275fac=function(t){return new(t||r)};static \u0275cmp=c({type:r,selectors:[["pd-create-prompt-page"]],decls:3,vars:2,consts:[["form",""],["titulo","Nuevo Prompt",3,"apply","enabled","waiting"],[3,"valid","submiting"]],template:function(t,i){if(t&1){let a=M();o(0,"pd-task-header",1),u("apply",function(v){b(a);let ge=E(2);return S(ge.onSubmit(v))}),n(),o(1,"pd-create-prompt-form",2,0),u("valid",function(v){return b(a),S(i.enabled.set(v))})("submiting",function(v){return b(a),S(i.submitting.set(v))}),n()}t&2&&m("enabled",i.enabled())("waiting",i.submitting())},dependencies:[te,oe],encapsulation:2})};var H=class r{store=p(K);listData=g(this.store.get("navListConfig")??{category:"alpha",tag:"qty"});appService=p(h);list=g(this.store.get("navList")??"category");sort=f(()=>this.listData()[this.list()]??"qty");sortedItems=f(()=>{let e=this.list()==="category"?this.appService.categories():this.appService.tags(),t=this.sort();return e?e.sort((i,a)=>t==="qty"?a.prompt_count-i.prompt_count:i.name.localeCompare(a.name)):[]});async onClick(e,t){e.stopPropagation(),this.list.set(t),this.store.save("navList",t)}onSortChange(){let t=this.sort()==="qty"?"alpha":"qty";this.listData.update(i=>j(q({},i),{[this.list()]:t})),this.store.save("navListConfig",this.listData())}inactivo=f(()=>this.list()==="category"?F.tag.title:F.category.title);activo=f(()=>F[this.list()].title);static \u0275fac=function(t){return new(t||r)};static \u0275cmp=c({type:r,selectors:[["pd-nav-menu"]],decls:12,vars:9,consts:[[1,"bg-drawer-header","absolute","top-0","left-0","right-0","h-14","z-20","flex","items-center","pl-4","pr-5"],[1,"flex","items-center","justify-between","w-full"],[1,"font-semibold","text-list-name","pr-1"],[1,"cursor-pointer","text-xs","opacity-85",3,"click"],[1,"opacity-85","font-light","hover:opacity-100",3,"click"],[1,"w-full","absolute","top-14","bottom-0","right-0","overflow-x-hidden","overflow-y-auto"],[1,"pt-4","h-full"],["pd-nav-list","",3,"list","items"]],template:function(t,i){t&1&&(o(0,"h5",0)(1,"div",1)(2,"div")(3,"span",2),y(4),n(),o(5,"button",3),u("click",function(){return i.onSortChange()}),y(6),n()(),o(7,"span",4),u("click",function(s){return i.onClick(s,i.list()==="category"?"tag":"category")}),y(8),n()()(),o(9,"div",5)(10,"div",6),d(11,"nav",7),n()()),t&2&&(l(),U("flex-row",i.list()==="category")("flex-row-reverse",i.list()==="tag"),l(3),R(i.activo()),l(2),Z(" [",i.sort()==="qty"?"Num":"A-Z","] "),l(2),R(i.inactivo()),l(3),m("list",i.list())("items",i.sortedItems()))},dependencies:[ne],encapsulation:2})};function fe(r,e){if(r&1&&(o(0,"div",3),d(1,"ul",5),n()),r&2){let t=_();l(),m("prompts",t.persistService.prompts())}}function ve(r,e){r&1&&(o(0,"div",4)(1,"span",6)(2,"span",7),d(3,"span",8)(4,"span",9),n()(),o(5,"span",10),y(6,"cargando"),n(),o(7,"span",10),y(8,"prompts"),n()())}var me=class r{persistService=p(h);static \u0275fac=function(t){return new(t||r)};static \u0275cmp=c({type:r,selectors:[["pd-home"]],hostAttrs:[1,"w-full"],decls:6,vars:1,consts:[["drawer",""],["pd-main-header","",3,"open"],["pd-drawer","",1,"w-fit","select-none"],[1,"flex","flex-row","md:ml-72"],[1,"flex","flex-col","md:ml-72","items-center","justify-center","h-[80svh]"],["pd-prompts-list","",1,"px-6","py-6",3,"prompts"],[1,"relative","inline-flex","mb-2"],[1,"flex","size-5"],[1,"absolute","inline-flex","h-full","w-full","animate-ping","rounded-full","bg-primary","opacity-75"],[1,"relative","inline-flex","size-5","rounded-full","bg-primary-light"],[1,"opacity-95"]],template:function(t,i){if(t&1){let a=M();o(0,"header",1),u("open",function(){b(a);let v=E(2);return S(v.show())}),n(),o(1,"div",2,0),d(3,"pd-nav-menu"),n(),z(4,fe,2,1,"div",3)(5,ve,9,0,"div",4)}t&2&&(l(4),O(i.persistService.prompts().length>0?4:5))},dependencies:[A,X,Q,H],encapsulation:2})};var ye=(r,e)=>e.key;function be(r,e){if(r&1&&d(0,"li",3),r&2){let t=e.$implicit,i=_();m("label",t.label)("value",i.prompt()[t.key])}}var ce=class r{notificationService=p(k);persistService=p(h);url=g(window.location.href);route=p(D);router=p(P);data=L(this.route.data);copyService=p(J);prompt=f(()=>this.data().prompt);displayProperties=[{label:"T\xEDtulo",key:"titulo"},{label:"Texto",key:"prompt"},{label:"Descripci\xF3n",key:"descripcion"},{label:"Autor",key:"autor"},{label:"Categor\xEDa",key:"categoria"},{label:"Creado",key:"fecha_creacion"},{label:"Etiquetas",key:"tags"},{label:"ID",key:"id"}];constructor(e){e.setTitle(`${this.prompt().titulo} | Prompter`)}onDelete(e){e.stopPropagation(),this.persistService.deletePrompt(this.prompt().id),this.notificationService.success("Prompt eliminado"),this.router.navigate(["/"])}onCopyPrompt(e){e.stopPropagation(),this.copyService.copy(this.prompt().prompt)}async onShare(e){if(e.stopPropagation(),!navigator.canShare){this.copyService.copy(this.url());return}let t=this.prompt(),i=this.url(),a={title:"Prompter",text:t.titulo,url:i};if(navigator.canShare(a))try{await navigator.share(a)}catch(s){console.warn("Error al compartir el prompt:",s)}else this.copyService.copy(this.url())}static \u0275fac=function(t){return new(t||r)(N(I))};static \u0275cmp=c({type:r,selectors:[["pd-prompt-detail"]],hostAttrs:[1,"w-full"],decls:5,vars:1,consts:[["pd-detail-header","",3,"delete","copyPrompt","share","titulo"],[1,"px-6","py-6","w-full"],[1,"divide-y-[0.5px]","divide-gray-500/50","space-y-2"],["pd-key-value-item","",3,"label","value"]],template:function(t,i){t&1&&(o(0,"header",0),u("delete",function(s){return i.onDelete(s)})("copyPrompt",function(s){return i.onCopyPrompt(s)})("share",function(s){return i.onShare(s)}),n(),o(1,"div",1)(2,"ul",2),w(3,be,1,2,"li",3,ye),n()()),t&2&&(m("titulo",i.prompt().titulo),l(3),T(i.displayProperties))},dependencies:[W,re],encapsulation:2})};var de=class r{notificationService=p(k);router=p(P);route=p(D);persist=p(h);data=L(this.route.data);prompts=f(()=>this.data().item.prompts);titulo=f(()=>this.data().item.name);subtitulo=f(()=>this.resolvedSubtitulo(this.prompts().length,this.data().type.lowercase));borrable=f(()=>this.prompts().length<=0);constructor(e){e.setTitle(`${this.data()?.item.name} | ${this.data()?.type.title} | Prompter`)}async onDelete(e){e.stopPropagation(),this.borrable()&&(this.data()?.type.lowercase==="etiqueta"?this.persist.deleteTag(this.data()?.item.name).then(()=>{this.notificationService.success("Etiqueta eliminada."),this.router.navigate(["/"])}):this.persist.deleteCategory(this.data()?.item.name).then(()=>{this.notificationService.success("Categor\xEDa eliminada."),this.router.navigate(["/"])}))}resolvedSubtitulo(e,t){return`${e===0?"Ning\xFAn prompt asociado":e===1?"1 prompt asociado":`${e.toFixed(0)} prompts asociados`} a esta ${t}`}static \u0275fac=function(t){return new(t||r)(N(I))};static \u0275cmp=c({type:r,selectors:[["pd-prompts"]],hostAttrs:[1,"w-full"],decls:3,vars:4,consts:[["pd-section-header","",3,"delete","titulo","subtitulo","enabled"],[1,"flex","flex-row","w-full"],["pd-prompts-list","",1,"p-4",3,"prompts"]],template:function(t,i){t&1&&(o(0,"header",0),u("delete",function(s){return i.onDelete(s)}),n(),o(1,"div",1),d(2,"ul",2),n()),t&2&&(m("titulo",i.titulo())("subtitulo",i.subtitulo())("enabled",i.borrable()),l(2),m("prompts",i.prompts()))},dependencies:[A,ee],encapsulation:2})};var Se=(r,e)=>["/",r,e],_e=(r,e)=>e.id;function De(r,e){if(r&1&&(o(0,"li",2)(1,"a",3),d(2,"pd-highlighted-text",4)(3,"pd-highlighted-text",5)(4,"pd-highlighted-text",6),n()()),r&2){let t=e.$implicit,i=_();l(),m("routerLink",B(4,Se,i.promptUrl,t.originalItem.slug)),l(),m("textData",t.titulo),l(),m("textData",t.prompt),l(),m("textData",t.descripcion)}}var ue=class r{longitud=50;route=p(D);router=p(P);persistService=p(h);emptySearch=[];currentSearchTerm=g("");promptUrl="prompt";allSearchResults=g([]);initSearch=g("");ngOnInit(){this.route.queryParams.pipe($(e=>e.search),V(e=>e.search)).subscribe(e=>{this.initSearch.set(e)})}onSearch(e){if(this.router.navigate([],{relativeTo:this.route,queryParams:{search:e.trim()},queryParamsHandling:"merge"}),e.length===0){this.allSearchResults.set(this.emptySearch),this.currentSearchTerm.set("");return}this.currentSearchTerm.set(e);let t=this.persistService.search(e);if(t.found.length===0){this.allSearchResults.set([]);return}let i=t.found.map(a=>{let s={id:a.item.id,titulo:{parts:[],in:-1},prompt:{parts:[],in:-1},descripcion:{parts:[],in:-1},autor:{parts:[],in:-1},matchType:a.relevanceScore===1?"exact":"fuzzy",matchScore:a.relevanceScore,originalItem:a.item};if(e.length>0&&a.foundIn!=="tags"&&a.foundIn!=="categoria"){let v=ae(a.item[a.foundIn],e,this.longitud);s[a.foundIn]={parts:v.parts,in:v.highlightIndex}}return this.fillEmptyFields(s,a.item),s});this.allSearchResults.set(i)}fillEmptyFields(e,t){e.titulo.parts.length===0&&(e.titulo={parts:[t.titulo.slice(0,this.longitud)],in:-1}),e.prompt.parts.length===0&&(e.prompt={parts:[t.prompt.slice(0,this.longitud)],in:-1}),e.descripcion.parts.length===0&&(e.descripcion={parts:[`${t.descripcion.slice(0,this.longitud)}...`],in:-1})}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=c({type:r,selectors:[["pd-searching"]],decls:4,vars:1,consts:[["pd-search-header","",3,"search","term"],[1,"divide-y-[0.5px]","divide-gray-500/50","px-6","py-4"],[1,"overflow-x-hidden","py-2","w-full","group"],[1,"opacity-90","group-hover:opacity-100","transition-opacity",3,"routerLink"],[1,"text-primary-dark","font-titulo","text-sm/5",3,"textData"],[1,"font-merri","italic",3,"textData"],[1,"text-sm/5",3,"textData"]],template:function(t,i){t&1&&(o(0,"header",0),u("search",function(s){return i.onSearch(s)}),n(),o(1,"ul",1),w(2,De,5,7,"li",2,_e),n()),t&2&&(m("term",i.initSearch()),l(2),T(i.allSearchResults()))},dependencies:[Y,ie,G],encapsulation:2})};export{pe as AdminPage,le as CreatePromptPage,me as Home,ce as PromptDetail,de as Prompts,ue as Searching};
