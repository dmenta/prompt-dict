import{a as A,b as Te,c as j,d as _e,e as Pe}from"./chunk-7MWPZS4L.js";import{B as se,C as ae,Ca as fe,Da as he,E as W,F as R,G as d,H as a,I as l,J as v,K as H,L as m,M as _,N as K,O as le,P,Q as $,R as ce,Ra as ge,Sa as ve,T as pe,Ta as Se,Ua as ye,Va as be,Wa as we,X as S,a as I,ab as De,b as F,c as J,d as M,e as Q,f as ee,fa as V,g as O,ga as C,h as z,i as te,ia as E,j as c,ja as de,k as y,l as b,n as u,na as L,o as ie,oa as me,p as re,pa as ue,q as p,r as T,ra as U,s as g,t as oe,w as q,x as ne,ya as w}from"./chunk-KB2QL4NB.js";var Ce=class t{static \u0275fac=function(i){return new(i||t)};static \u0275cmp=g({type:t,selectors:[["pd-admin-page"]],decls:1,vars:0,template:function(i,r){i&1&&v(0,"pd-admin-management")},dependencies:[Pe],encapsulation:2})};var Ee=class t{enabled=u(!1);submitting=u(!1);static \u0275fac=function(i){return new(i||t)};static \u0275cmp=g({type:t,selectors:[["pd-create-prompt-page"]],decls:3,vars:2,consts:[["form",""],["titulo","Nuevo Prompt",3,"apply","enabled","waiting"],[3,"valid","submiting"]],template:function(i,r){if(i&1){let o=H();a(0,"pd-task-header",1),m("apply",function(s){y(o);let f=K(2);return b(f.onSubmit(s))}),l(),a(1,"pd-create-prompt-form",2,0),m("valid",function(s){return y(o),b(r.enabled.set(s))})("submiting",function(s){return y(o),b(r.submitting.set(s))}),l()}i&2&&d("enabled",r.enabled())("waiting",r.submitting())},dependencies:[ye,Te],encapsulation:2})};function Ke(t,e,i,r){let o=window&&!!window.document&&window.document.documentElement,n=o&&e?window:i;if(t&&(n=t&&o&&typeof t=="string"?Ve(t,i.nativeElement,r):t,!n))throw new Error("ngx-infinite-scroll {resolveContainerElement()}: selector for");return n}function Ve(t,e,i){return(i?window.document:e).querySelector(t)}function Y(t){return t&&!t.firstChange}function Le(){return typeof window<"u"}var Ue={clientHeight:"clientHeight",offsetHeight:"offsetHeight",scrollHeight:"scrollHeight",pageYOffset:"pageYOffset",offsetTop:"offsetTop",scrollTop:"scrollTop",top:"top"},Ae={clientHeight:"clientWidth",offsetHeight:"offsetWidth",scrollHeight:"scrollWidth",pageYOffset:"pageXOffset",offsetTop:"offsetLeft",scrollTop:"scrollLeft",top:"left"},B=class{constructor(e=!0){this.vertical=e,this.propsMap=e?Ue:Ae}clientHeightKey(){return this.propsMap.clientHeight}offsetHeightKey(){return this.propsMap.offsetHeight}scrollHeightKey(){return this.propsMap.scrollHeight}pageYOffsetKey(){return this.propsMap.pageYOffset}offsetTopKey(){return this.propsMap.offsetTop}scrollTopKey(){return this.propsMap.scrollTop}topKey(){return this.propsMap.top}};function je(t,e,i){return!!(t&&e||!i&&e)}function ze({windowElement:t,axis:e}){return qe({axis:e,isWindow:$e(t)},t)}function qe(t,e){let i=t.isWindow||e&&!e.nativeElement?e:e.nativeElement;return F(I({},t),{container:i})}function $e(t){return["Window","global"].some(i=>Object.prototype.toString.call(t).includes(i))}function Z(t,e){return t?e.document.documentElement:null}function xe(t,e){let i=Xe(e);return e.isWindow?Ye(i,t,e):Be(i,t,e)}function Ye(t,e,i){let{axis:r,container:o,isWindow:n}=i,{offsetHeightKey:s,clientHeightKey:f}=Ne(r),D=t+He(Z(n,o),r,n),h=Me(e.nativeElement,n,s,f),N=Ge(e.nativeElement,r,n)+h;return{height:t,scrolled:D,totalToScroll:N,isWindow:n}}function Be(t,e,i){let{axis:r,container:o}=i,n=o[r.scrollTopKey()],s=o[r.scrollHeightKey()];return{height:t,scrolled:n,totalToScroll:s,isWindow:!1}}function Ne(t){return{offsetHeightKey:t.offsetHeightKey(),clientHeightKey:t.clientHeightKey()}}function Xe({container:t,isWindow:e,axis:i}){let{offsetHeightKey:r,clientHeightKey:o}=Ne(i);return Me(t,e,r,o)}function Me(t,e,i,r){if(isNaN(t[i])){let o=Z(e,t);return o?o[r]:0}else return t[i]}function Ge(t,e,i){let r=e.topKey();if(t.getBoundingClientRect)return t.getBoundingClientRect()[r]+He(t,e,i)}function He(t,e,i){let r=e.pageYOffsetKey(),o=e.scrollTopKey(),n=e.offsetTopKey();return isNaN(window.pageYOffset)?Z(i,t)[o]:t.ownerDocument?t.ownerDocument.defaultView[r]:t[n]}function Ze(t,e={down:0,up:0},i){let r,o;if(t.totalToScroll<=0)return!1;let n=t.isWindow?t.scrolled:t.height+t.scrolled;if(i)r=(t.totalToScroll-n)/t.totalToScroll,o=(e?.down?e.down:0)/10;else{let f=t.scrolled+(t.totalToScroll-n);r=t.scrolled/f,o=(e?.up?e.up:0)/10}return r<=o}function Je(t,e){return t<e.scrolled}function Qe(t,e,i){let r=Je(t,e);return{fire:Ze(e,i,r),scrollDown:r}}var X=class{constructor(e){this.lastScrollPosition=0,this.lastTotalToScroll=0,this.totalToScroll=0,this.triggered={down:0,up:0},Object.assign(this,e)}updateScrollPosition(e){return this.lastScrollPosition=e}updateTotalToScroll(e){this.lastTotalToScroll!==e&&(this.lastTotalToScroll=this.totalToScroll,this.totalToScroll=e)}updateScroll(e,i){this.updateScrollPosition(e),this.updateTotalToScroll(i)}updateTriggeredFlag(e,i){i?this.triggered.down=e:this.triggered.up=e}isTriggeredScroll(e,i){return i?this.triggered.down===e:this.triggered.up===e}};function et(t){let{scrollContainer:e,scrollWindow:i,element:r,fromRoot:o}=t,n=ze({axis:new B(!t.horizontal),windowElement:Ke(e,i,r,o)}),s=new X({totalToScroll:xe(r,n).totalToScroll}),f={container:n.container,throttle:t.throttle},D={up:t.upDistance,down:t.downDistance};return tt(f).pipe(Q(()=>J(xe(r,n))),M(h=>it(s.lastScrollPosition,h,D)),z(({stats:h})=>s.updateScroll(h.scrolled,h.totalToScroll)),O(({fire:h,scrollDown:N,stats:{totalToScroll:Re}})=>je(t.alwaysCallback,h,s.isTriggeredScroll(Re,N))),z(({scrollDown:h,stats:{totalToScroll:N}})=>{s.updateTriggeredFlag(N,h)}),M(rt))}function tt(t){let e=ee(t.container,"scroll");return t.throttle&&(e=e.pipe(te(t.throttle,void 0,{leading:!0,trailing:!0}))),e}function it(t,e,i){let{scrollDown:r,fire:o}=Qe(t,e,i);return{scrollDown:r,fire:o,stats:e}}var G={DOWN:"[NGX_ISE] DOWN",UP:"[NGX_ISE] UP"};function rt(t){let{scrollDown:e,stats:{scrolled:i}}=t;return{type:e?G.DOWN:G.UP,payload:{currentScrollPosition:i}}}var ke=(()=>{let e=class e{constructor(r,o){this.element=r,this.zone=o,this.scrolled=new q,this.scrolledUp=new q,this.infiniteScrollDistance=2,this.infiniteScrollUpDistance=1.5,this.infiniteScrollThrottle=150,this.infiniteScrollDisabled=!1,this.infiniteScrollContainer=null,this.scrollWindow=!0,this.immediateCheck=!1,this.horizontal=!1,this.alwaysCallback=!1,this.fromRoot=!1}ngAfterViewInit(){this.infiniteScrollDisabled||this.setup()}ngOnChanges({infiniteScrollContainer:r,infiniteScrollDisabled:o,infiniteScrollDistance:n}){let s=Y(r),f=Y(o),D=Y(n),h=!f&&!this.infiniteScrollDisabled||f&&!o.currentValue||D;(s||f||D)&&(this.destroyScroller(),h&&this.setup())}ngOnDestroy(){this.destroyScroller()}setup(){Le()&&this.zone.runOutsideAngular(()=>{this.disposeScroller=et({fromRoot:this.fromRoot,alwaysCallback:this.alwaysCallback,disable:this.infiniteScrollDisabled,downDistance:this.infiniteScrollDistance,element:this.element,horizontal:this.horizontal,scrollContainer:this.infiniteScrollContainer,scrollWindow:this.scrollWindow,throttle:this.infiniteScrollThrottle,upDistance:this.infiniteScrollUpDistance}).subscribe(r=>this.handleOnScroll(r))})}handleOnScroll({type:r,payload:o}){let n=r===G.DOWN?this.scrolled:this.scrolledUp;ot(n)&&this.zone.run(()=>n.emit(o))}destroyScroller(){this.disposeScroller&&this.disposeScroller.unsubscribe()}};e.\u0275fac=function(o){return new(o||e)(T(re),T(ne))},e.\u0275dir=oe({type:e,selectors:[["","infiniteScroll",""],["","infinite-scroll",""],["","data-infinite-scroll",""]],inputs:{infiniteScrollDistance:"infiniteScrollDistance",infiniteScrollUpDistance:"infiniteScrollUpDistance",infiniteScrollThrottle:"infiniteScrollThrottle",infiniteScrollDisabled:"infiniteScrollDisabled",infiniteScrollContainer:"infiniteScrollContainer",scrollWindow:"scrollWindow",immediateCheck:"immediateCheck",horizontal:"horizontal",alwaysCallback:"alwaysCallback",fromRoot:"fromRoot"},outputs:{scrolled:"scrolled",scrolledUp:"scrolledUp"},features:[ie]});let t=e;return t})();function ot(t){return t.observed??t.observers.length>0}function nt(t,e){if(t&1){let i=H();a(0,"div",10),m("scrolled",function(){y(i);let o=_();return b(o.onScrollDown())}),a(1,"div",11),v(2,"ul",12),l()()}if(t&2){let i=_();d("infiniteScrollDistance",i.scrollDistance)("infiniteScrollUpDistance",i.scrollUpDistance)("infiniteScrollThrottle",i.throttle),p(2),d("prompts",i.prompts())}}function st(t,e){t&1&&(a(0,"div",9)(1,"span",13)(2,"span",14),v(3,"span",15)(4,"span",16),l()(),a(5,"span",17),P(6,"cargando"),l(),a(7,"span",17),P(8,"prompts"),l()())}var Ie=class t{throttle=300;scrollDistance=1;scrollUpDistance=2;direction="";store=c(ue);listData=u(this.store.get("navListConfig")??{category:"alpha",tag:"qty"});persistService=c(w);prompts=u([]);list=u(this.store.get("navList")??"category");sort=S(()=>this.listData()[this.list()]??"qty");constructor(){this.persistService.prompts().subscribe(e=>{this.prompts.set(e)})}onClick(e,i){e.stopPropagation(),this.list.set(i),this.store.save("navList",i)}onSortChange(){let i=this.sort()==="qty"?"alpha":"qty";this.listData.update(r=>F(I({},r),{[this.list()]:i})),this.store.save("navListConfig",this.listData())}inactivo=S(()=>this.list()==="category"?j.tag.title:j.category.title);activo=S(()=>j[this.list()].title);onScrollDown(){this.persistService.prompts().subscribe(e=>{this.prompts.set(e)})}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=g({type:t,selectors:[["pd-home"]],hostAttrs:[1,"w-full"],decls:14,vars:10,consts:[["drawer",""],["pd-main-header","",3,"open"],["pd-drawer","",1,"w-fit","select-none"],["drawer-title","",1,"flex","items-center","justify-between","w-full"],[1,"font-semibold","text-list-name","pr-1"],[1,"cursor-pointer","text-xs","opacity-85",3,"click"],[1,"opacity-85","font-light","hover:opacity-100",3,"click"],["pd-nav-list","",3,"list","sort"],["infiniteScroll","",3,"infiniteScrollDistance","infiniteScrollUpDistance","infiniteScrollThrottle"],[1,"flex","flex-col","md:ml-72","items-center","justify-center","h-[80svh]"],["infiniteScroll","",3,"scrolled","infiniteScrollDistance","infiniteScrollUpDistance","infiniteScrollThrottle"],[1,"flex","flex-row","md:ml-72"],["pd-prompts-list","",1,"px-6","py-6",3,"prompts"],[1,"relative","inline-flex","mb-2"],[1,"flex","size-5"],[1,"absolute","inline-flex","h-full","w-full","animate-ping","rounded-full","bg-primary","opacity-75"],[1,"relative","inline-flex","size-5","rounded-full","bg-primary-light"],[1,"opacity-95"]],template:function(i,r){if(i&1){let o=H();a(0,"header",1),m("open",function(){y(o);let s=K(2);return b(s.show())}),l(),a(1,"div",2,0)(3,"div",3)(4,"div")(5,"span",4),P(6),l(),a(7,"button",5),m("click",function(){return y(o),b(r.onSortChange())}),P(8),l()(),a(9,"span",6),m("click",function(s){return y(o),b(r.onClick(s,r.list()==="category"?"tag":"category"))}),P(10),l()(),v(11,"nav",7),l(),se(12,nt,3,4,"div",8)(13,st,9,0,"div",9)}i&2&&(p(3),le("flex-row",r.list()==="category")("flex-row-reverse",r.list()==="tag"),p(3),$(r.activo()),p(2),ce(" [",r.sort()==="qty"?"Num":"A-Z","] "),p(2),$(r.inactivo()),p(),d("list",r.list())("sort",r.sort()),p(),ae(r.prompts().length>0?12:13))},dependencies:[A,ge,fe,_e,ke],encapsulation:2})};var lt=(t,e)=>e.key;function ct(t,e){if(t&1&&v(0,"li",3),t&2){let i=e.$implicit,r=_();d("label",i.label)("value",r.prompt()[i.key])}}var Fe=class t{notificationService=c(L);persistService=c(w);url=u(window.location.href);route=c(C);router=c(E);data=U(this.route.data);copyService=c(me);prompt=S(()=>this.data().prompt);displayProperties=[{label:"T\xEDtulo",key:"titulo"},{label:"Texto",key:"prompt"},{label:"Descripci\xF3n",key:"descripcion"},{label:"Autor",key:"autor"},{label:"Categor\xEDa",key:"categoria"},{label:"Creado",key:"fecha_creacion"},{label:"Etiquetas",key:"tags"},{label:"ID",key:"id"}];constructor(e){e.setTitle(`${this.prompt().titulo} | Prompter`)}onDelete(e){e.stopPropagation(),this.persistService.deletePrompt(this.prompt().id),this.notificationService.success("Prompt eliminado"),this.router.navigate(["/"])}onCopyPrompt(e){e.stopPropagation(),this.copyService.copy(this.prompt().prompt)}async onShare(e){if(e.stopPropagation(),!navigator.canShare){this.copyService.copy(this.url());return}let i=this.prompt(),r=this.url(),o={title:"Prompter",text:i.titulo,url:r};if(navigator.canShare(o))try{await navigator.share(o)}catch(n){console.warn("Error al compartir el prompt:",n)}else this.copyService.copy(this.url())}static \u0275fac=function(i){return new(i||t)(T(V))};static \u0275cmp=g({type:t,selectors:[["pd-prompt-detail"]],hostAttrs:[1,"w-full"],decls:5,vars:1,consts:[["pd-detail-header","",3,"delete","copyPrompt","share","titulo"],[1,"px-6","py-6","w-full"],[1,"divide-y-[0.5px]","divide-gray-500/50","space-y-2"],["pd-key-value-item","",3,"label","value"]],template:function(i,r){i&1&&(a(0,"header",0),m("delete",function(n){return r.onDelete(n)})("copyPrompt",function(n){return r.onCopyPrompt(n)})("share",function(n){return r.onShare(n)}),l(),a(1,"div",1)(2,"ul",2),W(3,ct,1,2,"li",3,lt),l()()),i&2&&(d("titulo",r.prompt().titulo),p(3),R(r.displayProperties))},dependencies:[he,we],encapsulation:2})};var Oe=class t{notificationService=c(L);router=c(E);route=c(C);persist=c(w);data=U(this.route.data);prompts=S(()=>this.data().item.prompts);titulo=S(()=>this.data().item.name);subtitulo=S(()=>this.resolvedSubtitulo(this.prompts().length,this.data().type.lowercase));borrable=S(()=>this.prompts().length<=0);constructor(e){e.setTitle(`${this.data()?.item.name} | ${this.data()?.type.title} | Prompter`)}onDelete(e){e.stopPropagation(),this.borrable()&&(this.data()?.type.lowercase==="etiqueta"?this.persist.deleteTag(this.data()?.item.name).subscribe(()=>{this.notificationService.success("Etiqueta eliminada."),this.router.navigate(["/"])}):this.persist.deleteCategory(this.data()?.item.name).subscribe(()=>{this.notificationService.success("Categor\xEDa eliminada."),this.router.navigate(["/"])}))}resolvedSubtitulo(e,i){return`${e===0?"Ning\xFAn prompt asociado":e===1?"1 prompt asociado":`${e.toFixed(0)} prompts asociados`} a esta ${i}`}static \u0275fac=function(i){return new(i||t)(T(V))};static \u0275cmp=g({type:t,selectors:[["pd-prompts"]],hostAttrs:[1,"w-full"],decls:3,vars:4,consts:[["pd-section-header","",3,"delete","titulo","subtitulo","enabled"],[1,"flex","flex-row","w-full"],["pd-prompts-list","",1,"p-4",3,"prompts"]],template:function(i,r){i&1&&(a(0,"header",0),m("delete",function(n){return r.onDelete(n)}),l(),a(1,"div",1),v(2,"ul",2),l()),i&2&&(d("titulo",r.titulo())("subtitulo",r.subtitulo())("enabled",r.borrable()),p(2),d("prompts",r.prompts()))},dependencies:[A,Se],encapsulation:2})};var pt=(t,e)=>["/",t,e],dt=(t,e)=>e.id;function mt(t,e){if(t&1&&(a(0,"li",2)(1,"a",3),v(2,"pd-highlighted-text",4)(3,"pd-highlighted-text",5)(4,"pd-highlighted-text",6),l()()),t&2){let i=e.$implicit,r=_();p(),d("routerLink",pe(4,pt,r.promptUrl,i.originalItem.slug)),p(),d("textData",i.titulo),p(),d("textData",i.prompt),p(),d("textData",i.descripcion)}}var We=class t{longitud=50;route=c(C);router=c(E);persistService=c(w);emptySearch=[];currentSearchTerm=u("");promptUrl="prompt";allSearchResults=u([]);initSearch=u("");ngOnInit(){this.route.queryParams.pipe(O(e=>e.search),M(e=>e.search)).subscribe(e=>{this.initSearch.set(e)})}onSearch(e){if(this.router.navigate([],{relativeTo:this.route,queryParams:{search:e.trim()},queryParamsHandling:"merge"}),e.length===0){this.allSearchResults.set(this.emptySearch),this.currentSearchTerm.set("");return}this.currentSearchTerm.set(e),this.persistService.search(e).subscribe(i=>{if(i.found.length===0){this.allSearchResults.set([]);return}let r=i.found.map(o=>{let n={id:o.item.id,titulo:{parts:[],in:-1},prompt:{parts:[],in:-1},descripcion:{parts:[],in:-1},autor:{parts:[],in:-1},matchType:o.relevanceScore===1?"exact":"fuzzy",matchScore:o.relevanceScore,originalItem:o.item};if(e.length>0&&o.foundIn!=="tags"&&o.foundIn!=="categoria"){let s=De(o.item[o.foundIn],e,this.longitud);n[o.foundIn]={parts:s.parts,in:s.highlightIndex}}return this.fillEmptyFields(n,o.item),n});this.allSearchResults.set(r)})}fillEmptyFields(e,i){e.titulo.parts.length===0&&(e.titulo={parts:[i.titulo.slice(0,this.longitud)],in:-1}),e.prompt.parts.length===0&&(e.prompt={parts:[i.prompt.slice(0,this.longitud)],in:-1}),e.descripcion.parts.length===0&&(e.descripcion={parts:[`${i.descripcion.slice(0,this.longitud)}...`],in:-1})}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=g({type:t,selectors:[["pd-searching"]],decls:4,vars:1,consts:[["pd-search-header","",3,"search","term"],[1,"divide-y-[0.5px]","divide-gray-500/50","px-6","py-4"],[1,"overflow-x-hidden","py-2","w-full","group"],[1,"opacity-90","group-hover:opacity-100","transition-opacity",3,"routerLink"],[1,"text-primary-dark","font-titulo","text-sm/5",3,"textData"],[1,"font-merri","italic",3,"textData"],[1,"text-sm/5",3,"textData"]],template:function(i,r){i&1&&(a(0,"header",0),m("search",function(n){return r.onSearch(n)}),l(),a(1,"ul",1),W(2,mt,5,7,"li",2,dt),l()),i&2&&(d("term",r.initSearch()),p(2),R(r.allSearchResults()))},dependencies:[ve,be,de],encapsulation:2})};export{Ce as AdminPage,Ee as CreatePromptPage,Ie as Home,Fe as PromptDetail,Oe as Prompts,We as Searching};
