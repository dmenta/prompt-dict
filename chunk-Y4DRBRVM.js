import{C as E,J as I,L as b,M as D,U as _,V as R,_ as T,a as m,aa as P,b as u,d as p,i as c,j as n,k as g,o as S,p as y,q as s,r as l,s as h,t as f,v,w as x}from"./chunk-3DBPWMPE.js";var k=(r,t)=>["/",r,t],F=(r,t)=>t.id;function M(r,t){if(r&1&&(l(0,"li",2)(1,"a",3),f(2,"pd-highlighted-text",4)(3,"pd-highlighted-text",5)(4,"pd-highlighted-text",6),h()()),r&2){let e=t.$implicit,a=x();n(),s("routerLink",E(4,k,a.promptUrl,e.originalItem.slug)),n(),s("textData",e.titulo),n(),s("textData",e.prompt),n(),s("textData",e.descripcion)}}var C=class r{longitud=50;route=p(I);router=p(b);persistService=p(R);emptySearch=this.persistService.prompts().slice(0,10).map(t=>({id:t.id,titulo:{parts:[t.titulo.slice(0,this.longitud)],in:-1},prompt:{parts:[t.prompt.slice(0,this.longitud)],in:-1},descripcion:{parts:[`${t.descripcion.slice(0,this.longitud)}...`],in:-1},autor:{parts:[t.autor.slice(0,this.longitud)],in:-1},matchType:"exact",matchScore:1,originalItem:t}));currentSearchTerm=c("");promptUrl="prompt";allSearchResults=c([]);initSearch=c("");ngOnInit(){this.route.queryParams.pipe(u(t=>t.search),m(t=>t.search)).subscribe(t=>{this.initSearch.set(t)})}onSearch(t){if(this.router.navigate([],{relativeTo:this.route,queryParams:{search:t.trim()},queryParamsHandling:"merge"}),t.length===0){this.allSearchResults.set(this.emptySearch),this.currentSearchTerm.set("");return}this.currentSearchTerm.set(t);let e=this.persistService.search(t,!0);if(e.found.length===0){this.allSearchResults.set([]);return}let a=e.found.map(i=>{let o={id:i.item.id,titulo:{parts:[],in:-1},prompt:{parts:[],in:-1},descripcion:{parts:[],in:-1},autor:{parts:[],in:-1},matchType:i.relevanceScore===1?"exact":"fuzzy",matchScore:i.relevanceScore,originalItem:i.item};if(t.length>0&&i.foundIn!=="tags"&&i.foundIn!=="categoria"){let d=_(i.item[i.foundIn],t,this.longitud);o[i.foundIn]={parts:d.parts,in:d.highlightIndex}}return this.fillEmptyFields(o,i.item),o});this.allSearchResults.set(a)}fillEmptyFields(t,e){t.titulo.parts.length===0&&(t.titulo={parts:[e.titulo.slice(0,this.longitud)],in:-1}),t.prompt.parts.length===0&&(t.prompt={parts:[e.prompt.slice(0,this.longitud)],in:-1}),t.descripcion.parts.length===0&&(t.descripcion={parts:[`${e.descripcion.slice(0,this.longitud)}...`],in:-1})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=g({type:r,selectors:[["pd-searching"]],decls:4,vars:1,consts:[["pd-search-header","",3,"search","term"],[1,"divide-y-[0.5px]","divide-gray-500/50","px-6","py-4"],[1,"overflow-x-hidden","py-2","w-full","group"],[1,"opacity-90","group-hover:opacity-100","transition-opacity",3,"routerLink"],[1,"text-primary-dark","uppercase","font-semibold","text-sm/5",3,"textData"],[1,"font-merri","italic",3,"textData"],[1,"text-sm/5",3,"textData"]],template:function(e,a){e&1&&(l(0,"header",0),v("search",function(o){return a.onSearch(o)}),h(),l(1,"ul",1),S(2,M,5,7,"li",2,F),h()),e&2&&(s("term",a.initSearch()),n(2),y(a.allSearchResults()))},dependencies:[T,P,D],encapsulation:2})};export{C as Searching};
